"use strict";(self["webpackChunkvaxo"]=self["webpackChunkvaxo"]||[]).push([[211],{3560:function(e,s,a){a.d(s,{L:function(){return o}});a(7658);var l=a(4870),t=a(5543),r=a(4850);const o=(0,t.Q_)("user",(()=>{const e=(0,l.iH)(null),s=(0,l.iH)([]),a=(0,l.iH)(null),t=async()=>{try{e.value=null;const a=await r.iJ.get("/api/users/agencyUsers",{showLoader:!0});return 200===a.status?(s.value=a.data,{success:!0}):{success:!1}}catch(a){return e.value=a instanceof Error?a:new Error("Failed to load users"),console.log(a),{success:!1}}},o=async a=>{try{e.value=null;const l=await r.iJ.post("/api/auth/platform/register-user",a,{showLoader:!0});if(201===l.status){const e=l.data;return e.roles=["admin"],s.value.push(e),{success:!0}}return{success:!1}}catch(l){return Array.isArray(l)?(e.value=l,{success:!1}):(e.value=l instanceof Error?l:new Error("Failed to add user"),{success:!1})}},n=async a=>{try{e.value=null;const l=await r.iJ.delete(`/api/users/${a.email}`,{showLoader:!0});if(204===l.status){const e=s.value.findIndex((e=>e.id===a.id));return-1!==e&&s.value.splice(e,1),{success:!0}}return{success:!1}}catch(l){return e.value=l instanceof Error?l:new Error("Failed to delete user"),{success:!1}}},c=async()=>{try{e.value=null;const s=await r.iJ.get("/api/users/profile",{showLoader:!0});return 200===s.status?(a.value=s.data,{success:!0}):{success:!1}}catch(s){return e.value=s instanceof Error?s:new Error("Failed to fetch profile details"),console.log(s),{success:!1}}},i=async s=>{try{e.value=null;const a=await r.iJ.post("/api/users/changePassword",s,{showLoader:!0});return 204===a.status?{success:!0}:{success:!1}}catch(a){return e.value=a instanceof Error?a:"Failed to change the password",console.log("ERROR***",e.value),{success:!1}}};return{error:e,users:s,profile:a,loadUsers:t,addNewUser:o,deleteUser:n,fetchProfile:c,changePassword:i}}))},211:function(e,s,a){a.r(s),a.d(s,{default:function(){return O}});var l=a(3396),t=a(4870),r=a(7139),o=a(9242),n=a(7920),c=a(8890);const i={class:"card border-0 box-shadow border-radius-10 mb-4"},u={class:"card-body p-4"},d={class:"all-table scroll-bar h-624 mb-5"},m={class:"table align-middle"},f={class:"ps-0"},p={class:"text-start text-dark"},v={class:"d-block text-dark"},b={class:"d-block text-dark"},w={class:"d-block text-dark"},_={class:"d-block text-dark"},h={class:"text-end text-center"},g={class:"dropdown action-opt"},y={class:"btn bg-transparent p-0",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},x={class:"dropdown-menu"},k=["onClick"];var U=(0,l.aZ)({__name:"UsersList",props:{users:{}},emits:["delete-user"],setup(e,{emit:s}){const a=e,o=s,n=e=>({...e,roles:e.roles.join(",")}),U=()=>a.users.map(n),N=e=>{const s=a.users.find((s=>s.id===e.id));s&&o("delete-user",s)};return(e,s)=>{const a=(0,l.up)("vue-feather");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l._)("div",u,[(0,l._)("div",d,[(0,l._)("table",m,[s[1]||(s[1]=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{class:"text-dark fw-medium pt-0 pb-2 fs-14 ps-0",scope:"col"}," Name "),(0,l._)("th",{class:"text-dark fw-medium pt-0 pb-2 fs-14",scope:"col"}," Email "),(0,l._)("th",{class:"text-dark fw-medium pt-0 pb-2 fs-14",scope:"col"}," Phone "),(0,l._)("th",{class:"text-dark fw-medium pt-0 pb-2 fs-14",scope:"col"}," Last Active Date "),(0,l._)("th",{class:"text-dark fw-medium pt-0 pb-2 fs-14",scope:"col"}," Roles "),(0,l._)("th",{class:"text-dark fw-medium pt-0 pb-2 fs-14",scope:"col"})])],-1)),(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(U(),(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",f,[(0,l._)("span",p,(0,r.zw)(e.fullName),1)]),(0,l._)("td",null,[(0,l._)("span",v,(0,r.zw)(e.email),1)]),(0,l._)("td",null,[(0,l._)("span",b,(0,r.zw)(e.phoneNumber),1)]),(0,l._)("td",null,[(0,l._)("span",w,(0,r.zw)((0,t.SU)(c.w)(e.lastActive)),1)]),(0,l._)("td",null,[(0,l._)("span",_,(0,r.zw)(e.roles),1)]),(0,l._)("td",h,[(0,l._)("div",g,[(0,l._)("button",y,[(0,l.Wm)(a,{type:"more-horizontal"})]),(0,l._)("ul",x,[(0,l._)("li",null,[(0,l._)("a",{class:"dropdown-item d-flex align-items-center",href:"javascript:;",onClick:s=>N(e)},[(0,l.Wm)(a,{type:"trash-2",size:"16",class:"me-2"}),s[0]||(s[0]=(0,l.Uk)(" Delete ",-1))],8,k)])])])])])))),128))])])])])])}}});const N=U;var E=N,L=a(3560),C=a(5543),D=a(2492),R=a.n(D),W=a(5469);const P={class:"container-fluid"},A={class:"inner-main-content"},S={class:"offcanvas offcanvas-custom offcanvas-end",tabindex:"-1",id:"offcanvasRight","aria-labelledby":"offcanvasRightLabel"},V={class:"offcanvas-header border-bottom"},z={class:"offcanvas-body"},F={key:0,id:"errorAlert",class:"alert alert-danger",role:"alert"},B={class:"row"},H={class:"col-lg-12"},q={class:"form-group mb-4"},J={class:"col-lg-12"},j={class:"form-group mb-4"},Z={class:"col-lg-12"},I={class:"form-group mb-4"},K={class:"col-lg-12"},Y={class:"form-group mb-4"};var T=(0,l.aZ)({__name:"UsersListPage",setup(e){const{loadUsers:s,addNewUser:a,deleteUser:c}=(0,L.L)(),{users:i,error:u}=(0,C.Jk)((0,L.L)());i.value=[];const d=(0,t.qj)({email:"",fullName:"",phoneNumber:"",password:""}),m={name:"required|min:3|max:100|alpha_spaces",email:"required|min:3|max:100|email",phoneNumber:"required",password:"required|min:5|max:100|excluded:password"},f=(0,t.iH)(),p=()=>{d.email="",d.fullName="",d.phoneNumber="",d.password="",u.value=null,f.value?.resetForm()},v=(0,t.iH)(null),{handleSubmit:b}=(0,W.cI)(),w=b((async()=>{if(!f.value)return;const{valid:e}=await f.value.validate();if(!e)return void console.log("Form has validation errors");const s=await a(d);s.success&&(R().fire({toast:!0,position:"top-end",icon:"success",title:"User was added successfully.",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),f.value?.resetForm(),v.value?.click())})),_=e=>{R().fire({title:"Are you sure you want to delete the user?",icon:"warning",showCancelButton:!0,confirmButtonText:"Confirm",cancelButtonText:"Cancel"}).then((async s=>{if(s.isConfirmed){const s=await c(e);s.success&&R().fire({toast:!0,position:"top-end",icon:"success",title:"User is deleted successfully",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}}))};return(0,l.bv)((()=>s())),(e,s)=>{const a=(0,l.up)("vee-field"),c=(0,l.up)("ErrorMessage"),b=(0,l.up)("vee-form");return(0,l.wg)(),(0,l.iD)("div",P,[(0,l._)("div",A,[s[11]||(s[11]=(0,l._)("div",{class:"card-title d-flex justify-content-between align-items-center mb-3"},[(0,l._)("h3",{class:"fw-medium fs-18 mb-0"},"User List")],-1)),(0,l._)("div",{class:"card-title d-flex justify-content-between align-items-center mb-3"},[s[4]||(s[4]=(0,l._)("div",null,null,-1)),(0,l._)("button",{class:"btn btn-primary default-btn",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasRight","aria-controls":"offcanvasRight",onClick:p}," + Add New User ")]),(0,l.Wm)(E,{users:(0,t.SU)(i),onDeleteUser:_},null,8,["users"]),(0,l._)("div",S,[(0,l._)("div",V,[s[5]||(s[5]=(0,l._)("h5",{class:"offcanvas-title fs-18",id:"offcanvasRightLabel"}," New User ",-1)),(0,l._)("button",{type:"button",ref_key:"closeButtonRef",ref:v,class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,512)]),(0,l._)("div",z,[(0,t.SU)(u)&&Array.isArray((0,t.SU)(u))&&(0,t.SU)(u).length>0?((0,l.wg)(),(0,l.iD)("div",F,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,t.SU)(u),((e,s)=>((0,l.wg)(),(0,l.iD)("div",{key:s},(0,r.zw)(e),1)))),128))])):(0,l.kq)("",!0),(0,l.Wm)(b,{ref_key:"formRef",ref:f,"validation-schema":m,onSubmit:(0,t.SU)(w)},{default:(0,l.w5)((()=>[(0,l._)("div",B,[(0,l._)("div",H,[(0,l._)("div",q,[s[6]||(s[6]=(0,l._)("label",{class:"label"},"Fullname",-1)),(0,l.Wm)(a,{type:"text",name:"name",class:"form-control",placeholder:"Enter Name",modelValue:d.fullName,"onUpdate:modelValue":s[0]||(s[0]=e=>d.fullName=e)},null,8,["modelValue"]),(0,l.Wm)(c,{class:"error-message",name:"name"})])]),(0,l._)("div",J,[(0,l._)("div",j,[s[7]||(s[7]=(0,l._)("label",{class:"label"},"Email Address",-1)),(0,l.Wm)(a,{type:"text",name:"email",class:"form-control",placeholder:"Enter Email",modelValue:d.email,"onUpdate:modelValue":s[1]||(s[1]=e=>d.email=e)},null,8,["modelValue"]),(0,l.Wm)(c,{class:"error-message",name:"email"})])]),(0,l._)("div",Z,[(0,l._)("div",I,[s[8]||(s[8]=(0,l._)("label",{class:"label"},"Phone",-1)),(0,l.Wm)(a,{type:"text",name:"phoneNumber",class:"form-control",placeholder:"Enter Phone",modelValue:d.phoneNumber,"onUpdate:modelValue":s[2]||(s[2]=e=>d.phoneNumber=e)},null,8,["modelValue"]),(0,l.Wm)(c,{class:"error-message",name:"phoneNumber"})])]),(0,l._)("div",K,[(0,l._)("div",Y,[s[9]||(s[9]=(0,l._)("label",{class:"label"},"Password",-1)),(0,l.Wm)(a,{name:"password",bails:!1},{default:(0,l.w5)((({field:e,errors:a})=>[(0,l.wy)((0,l._)("input",(0,l.dG)({type:"text",class:"form-control",placeholder:"Password"},e,{"onUpdate:modelValue":s[3]||(s[3]=e=>d.password=e)}),null,16),[[o.nr,d.password]]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"error-message",key:e},(0,r.zw)(e),1)))),128))])),_:1})])]),s[10]||(s[10]=(0,l._)("div",{class:"col-lg-12"},[(0,l._)("div",{class:"form-group"},[(0,l._)("button",{type:"submit",class:"default-btn"}," Register ")])],-1))])])),_:1},8,["onSubmit"])])]),(0,l.Wm)(n.Z)])])}}}),G=a(89);const M=(0,G.Z)(T,[["__scopeId","data-v-627cbcc1"]]);var O=M}}]);
//# sourceMappingURL=211.fbf7b536.js.map